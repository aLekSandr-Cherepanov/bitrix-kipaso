var flushTimeout,skuDropdownOpened=!1;$(function(){$body=$("body");var e=(()=>{var a={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,n){a[t]=n}),a})().offerID;e&&$.getJSON(elementAjaxPath+"?act=getOfferByID&id="+e,function(e){$.each(e[0],function(e,t){$(".elementSkuPropertyValue[data-name='"+e+"'][data-value='"+t+"']").find(".elementSkuPropertyLink").trigger("click",["ignoreLoading"])})}),$(document).on("click","#elementProperties .question",function(e){return $("#hint").remove(),$("#catalogElement").append($('<div id="hint">').html("<span>"+$(this).siblings().text()+"</span><ins></ins><p>"+$(this).data("description")+"</p>").css({top:$(this).position().top-20+"px",left:$(this).offset().left+40+"px"})),e.preventDefault()}),$(document).on("click","#hint ins",function(e){return $("#hint").remove(),e.preventDefault()});function t(e){(e=e.currentTarget.scrollY||$(window).scrollTop())<=l+f.height()?(p<=e?(u.addClass("fixed").find(".tabs").removeClass("maxScroll"),m.addClass("fixed")):(u.removeClass("fixed").find(".tabs").removeClass("maxScroll"),m.removeClass("fixed"))).find(".fixContainer").removeClass("maxScroll"):(u.removeClass("fixed").find(".tabs").addClass("maxScroll"),m.removeClass("fixed").find(".fixContainer").addClass("maxScroll"))}function n(e){var t=!0===e.data.lsWindow?"#setWPrice":"#setPrice",n=!0===e.data.lsWindow?"#setWDisnt":"#setDisnt",e=!0===e.data.lsWindow?"#setWindowPrice .addCart":".rt .addCart",a="disabled",o="price",i="discount",t=$(t),n=$(n);h=$(this),g=h.parents(".setElement"),h.toggleClass(a),g.toggleClass(a),s=h.hasClass(a)?-parseInt(g.data(o)):parseInt(g.data(o)),c=h.hasClass(a)?-(parseInt(g.data(o))+Math.ceil(g.data(i))):parseInt(g.data(o))+Math.ceil(g.data(i)),d=t.html().replace(/[0-9]/g,""),s=parseInt(t.html().replace(/[^0-9]/g,""))+s,r=n.html().replace(/[0-9]/g,""),c=parseInt(n.html().replace(/[^0-9]/g,""))+c,t.html(formatPrice(s)+d),n.html(formatPrice(c)+r),s==c?n.hide():n.show(),v=$(e),$_addCartImg=v.find("img"),v.text(v.data("text")).attr("href","#").removeClass("added").prepend($_addCartImg)}function a(e){var t=$(this),n=$("#elementError"),a="good"==e.data.dest;$.getJSON(ajaxPath+"?act=rating&id="+t.data("id")+"&trig="+a,function(e){e.result?t.find("span").html(parseInt(t.find("span").html())+1):n.show().find("p").text(e.error).parent().find(".heading").text(e.heading)}),e.preventDefault()}function o(e){var t=(o=$(this)).find(".m"),n=$("#ratingInput"),a=o.offset().left,o=o.width()/5,a=Math.ceil((e.pageX-a)/o);t.stop().css({width:20*a+"%"}),e.data.action&&n.val(a)}function i(e){f.removeClass("loading"),void 0!==e.COMPONENT_HTML&&""!=e.COMPONENT_HTML&&$body.append(e.COMPONENT_HTML)}var l,d,r,s,c,f=$("#catalogElement"),u=$("#elementNavigation"),m=$("#elementTools"),p=(l=u.find(".tabs").height()>m.find(".fixContainer").height()?f.offset().top-u.find(".tabs").outerHeight():f.offset().top-m.find(".fixContainer").outerHeight()-36,m.offset().top),h={},g={},v={};$(document).on("click",".showReviewDetail",function(e){var t=$(this),n=$("#reviews");scrollElement(n.children("li").eq(t.data("cnt")).offset().top),e.preventDefault()});$(document).on("mousemove","#newRating .rating",{action:!1},o),$(document).on("mouseleave","#newRating .rating",function(e){var t=$(this),n=$("#ratingInput"),a=""!=n.val()?parseInt(n.val()):0;clearTimeout(flushTimeout),flushTimeout=setTimeout(function(){t.find(".m").css({width:20*a+"%"})},500)}),$(document).on("click","#newRating .rating",{action:!0},o),$(document).on("click",".usedSelect a",function(e){var t=$(this),n=$(".usedSelect");$("#usedInput");n.find("a").removeClass("selected"),t.addClass("selected"),$("#usedInput").val(t.data("id")),e.preventDefault()}),$(document).on("click","#showallReviews",function(e){var t=$(this),n=$("#reviews");"N"==t.data("open")?(n.children("li").removeClass("hide"),t.data("open","Y").html(CATALOG_LANG.REVIEWS_HIDE)):(n.children("li").slice(3).addClass("hide"),t.data("open","N").html(CATALOG_LANG.REVIEWS_SHOW)),e.preventDefault()}),$(document).on("click","#newReview .submit",function(e){var t=$(this),n=$(this).parents("form").serialize(),a=$("#elementError");$.getJSON(ajaxPath+"?act=newReview&"+n+"&iblock_id="+t.data("id")+"&allow-register=y",function(e){"undefined"!=typeof globalSettings&&void 0!==globalSettings.TEMPLATE_METRICA_REVIEW_PRODUCT&&void 0!==globalSettings.TEMPLATE_METRICA_ID&&void 0!==window["yaCounter"+globalSettings.TEMPLATE_METRICA_ID]&&window["yaCounter"+globalSettings.TEMPLATE_METRICA_ID].reachGoal(globalSettings.TEMPLATE_METRICA_REVIEW_PRODUCT),a.show().find("p").text(e.message).parent().find(".heading").text(e.heading),e.reload&&a.data("reload",1)}),e.preventDefault()}),$(document).on("click","#elementErrorClose, #elementError .close",function(e){$("#elementError").data("reload")?document.location.reload():$("#elementError").hide(),e.preventDefault()}),$(document).on("click",".reviewAddButton",function(e){var t=$("#newReview");return t.show(),$("html, body").animate({scrollTop:t.offset().top+"px"},250),e.preventDefault()}),$(document).on("click",".countReviewsTools",function(e){var t=$("#catalogReviews");return $("html, body").animate({scrollTop:t.offset().top+"px"},250),e.preventDefault()}),$(document).on("click",".good",{dest:"good"},a),$(document).on("click",".bad",{dest:"bad"},a),$(window).on("ready scroll resize",t),$(document).on("load",t),$(document).on("click",".morePropertiesLink",function(e){return $("html, body").animate({scrollTop:$("#elementProperties").offset().top+"px"},250),e.preventDefault()}),$(document).on("click","#catalogElement .heading",function(e){var t=$(this);if(!t.hasClass("noTabs")&&$(window).innerWidth()<=620)return t.toggleClass("active"),t.siblings("div").eq(0).toggle(200),e.preventDefault()}),$(document).on("click",".sCheck",{lsWindow:!1},n),$(document).on("click",".sWindowCheck",{lsWindow:!0},n),$(document).on("click","#setWindow .close, #catalogElement .addSet, #setWindow .closeWindow",function(e){$("#setWindow").toggle(),e.preventDefault()}),$(document).on("click",".cheaper",function(e){var t=$(this).data("id"),t=$("#webFormDwModal_"+t),n=$(".cheaper-product-name");t.find(".product-auto-name").parents(".webFormItem").find(".inputtext").val(n.text()).prop("readonly","readonly")}),$(document).on("click",".calcDeliveryButton",function(e){var t=$(this).data("id");return"undefined"!=typeof SITE_ID?""!=t&&(t={product_id:t,act:"getFastDelivery",site_id:SITE_ID},"undefined"!=typeof fastDeliveryScriptLoaded&&(t.loadScript="N"),"undefined"!=typeof elementAjaxPath?(f.addClass("loading"),$.getJSON(elementAjaxPath,t,i)):console.error("var elementAjaxPath not found")):console.error("SITE_ID not found"),e.preventDefault()})});